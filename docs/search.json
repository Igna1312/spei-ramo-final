[
  {
    "objectID": "spei.html",
    "href": "spei.html",
    "title": "An√°lisis SPEI",
    "section": "",
    "text": "rm(list = ls())  # Limpia el entorno (opcional, para partir de cero)\n\n###########################################################\n# 1. Cargar paquetes necesarios\n###########################################################\npkgs &lt;- c(\"dplyr\", \"ggplot2\", \"SPEI\", \"lubridate\", \"purrr\", \"tibble\")\n\ninst &lt;- pkgs[!pkgs %in% installed.packages()[, \"Package\"]]\nif (length(inst) &gt; 0) install.packages(inst)\n\nlapply(pkgs, library, character.only = TRUE)\n\nWarning: package 'dplyr' was built under R version 4.5.2\n\n\n\nAdjuntando el paquete: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nWarning: package 'ggplot2' was built under R version 4.5.2\n\n\nWarning: package 'SPEI' was built under R version 4.5.2\n\n\n# Package SPEI (1.8.1) loaded [try SPEINews()].\n\n\nWarning: package 'lubridate' was built under R version 4.5.2\n\n\n\nAdjuntando el paquete: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\n\nWarning: package 'purrr' was built under R version 4.5.2\n\n\nWarning: package 'tibble' was built under R version 4.5.2\n\n\n[[1]]\n[1] \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\" \n[7] \"methods\"   \"base\"     \n\n[[2]]\n[1] \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\" \"utils\"    \n[7] \"datasets\"  \"methods\"   \"base\"     \n\n[[3]]\n [1] \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\"\n [7] \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[4]]\n [1] \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\" \n [7] \"grDevices\" \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[5]]\n [1] \"purrr\"     \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"    \n [7] \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[6]]\n [1] \"tibble\"    \"purrr\"     \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"    \n [7] \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"  \"methods\"  \n[13] \"base\"     \n\n###########################################################\n# 2. Leer las bases de cada estaci√≥n\n###########################################################\n\ncogoti_raw &lt;- read.csv(\n  \"data/cogoti_spei.csv\",\n  header = TRUE,\n  stringsAsFactors = FALSE\n)\n\nramadas_raw &lt;- read.csv(\n  \"data/ramadas_spei.csv\",\n  header = TRUE,\n  stringsAsFactors = FALSE,\n  sep = \";\"\n)\n\n# Revisa c√≥mo se llaman las columnas\nnames(cogoti_raw)\n\n[1] \"agno\" \"mes\"  \"dia\"  \"pmen\" \"tmax\" \"tmin\"\n\nnames(ramadas_raw)\n\n[1] \"agno\" \"mes\"  \"dia\"  \"pmen\" \"tmax\" \"tmin\"\n\n###########################################################\n# 3. Dejar los mismos nombres de columnas en ambas bases\n#    (agno, mes, dia, pmen, tmax, tmin)\n###########################################################\nnames(cogoti_raw)  &lt;- c(\"agno\", \"mes\", \"dia\", \"pmen\", \"tmax\", \"tmin\")\nnames(ramadas_raw) &lt;- c(\"agno\", \"mes\", \"dia\", \"pmen\", \"tmax\", \"tmin\")\n\n###########################################################\n# 4. Crear columna de fecha y marcar estaci√≥n meteorol√≥gica\n###########################################################\ncogoti &lt;- cogoti_raw |&gt;\n  mutate(\n    estacion = \"Cogot√≠\",\n    fecha    = make_date(year = agno, month = mes, day = dia)\n  )\n\nramadas &lt;- ramadas_raw |&gt;\n  mutate(\n    estacion = \"Las Ramadas\",\n    fecha    = make_date(year = agno, month = mes, day = dia)\n  )\n\n###########################################################\n# 5. Unir ambas estaciones en un solo data frame\n###########################################################\ndatos &lt;- bind_rows(cogoti, ramadas) |&gt;\n  arrange(estacion, fecha)\n\n###########################################################\n# 6. Calcular ETP (Hargreaves) y balance h√≠drico\n###########################################################\n# IMPORTANTE:\n# - Aqu√≠ puedes filtrar NAs si tu base tiene d√≠as/meses sin datos (ac√° hubieron como 4 datos perdidos OJITO).\n#   Ejemplo: filter(!is.na(tmax), !is.na(tmin), !is.na(pmen))\n###########################################################\ndatos &lt;- datos |&gt;\n  mutate(\n    etp  = hargreaves(tmin, tmax, lat = -31.035833),  # Cambia lat si quieres otra\n    bal  = pmen - etp\n  )\n\n[1] \"Calculating reference evapotranspiration using the Hargreaves method. Using latitude (`lat`) to estimate extraterrestrial radiation. Checking for missing values (`NA`): all the data must be complete. Input type is vector. Assuming the data are monthly time series starting in January, all regular (non-leap) years.\"\n\n###########################################################\n# 7. Usar purrr para calcular SPEI por estaci√≥n meteo\n###########################################################\n# Separa la base en una lista: una tabla por estaci√≥n (\"Cogot√≠\", \"Ramadas\")\nlista_est &lt;- split(datos, datos$estacion)\n\n# Funci√≥n que calcula SPEI k-mensual para una estaci√≥n\ncalc_spei_estacion &lt;- function(df, escala = 12) {\n  df &lt;- df[order(df$fecha), ]      # Ordenar por fecha por si acaso\n  spei_obj &lt;- spei(df$bal, escala) # C√°lculo de SPEI\n  \n  tibble(\n    fecha    = df$fecha,\n    estacion = unique(df$estacion),\n    spei     = as.numeric(spei_obj$fitted),\n    escala   = escala\n  )\n}\n\n# SPEI-12 meses \nspei12_est &lt;- map_dfr(lista_est, calc_spei_estacion, escala = 12)\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 12. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 12. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n\n# (Opcional) SPEI-3 meses:\nspei3_est  &lt;- map_dfr(lista_est, calc_spei_estacion, escala = 3)\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 3. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 3. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n\n###########################################################\n# 8. Gr√°fico tipo ‚Äúpluma‚Äù SPEI-12 (barras azules/rojas)\n###########################################################\n# AQU√ç ES DONDE PUEDES CAMBIAR:\n# - Colores de seco/h√∫medo (scale_fill_manual)\n# - T√≠tulo, ejes, tama√±o de letra (labs + theme)\n# - N¬∞ de columnas de los facets (facet_wrap)\n###########################################################\n\nggplot(spei12_est, aes(x = fecha, y = spei)) +\n  # L√≠nea horizontal en 0 (umbral neutral)\n  geom_hline(yintercept = 0, color = \"grey40\", linewidth = 0.4) +\n  \n  # Barras: las positivas van hacia arriba, las negativas hacia abajo\n  # Usamos ifelse dentro de aes(y = ...) para que siempre partan desde 0\n  geom_col(\n    data = ~ subset(.x, spei &gt;= 0),\n    aes(y = spei),\n    fill = \"#6a994e\",        # ‚Üê COLOR DE LAS BARRAS H√öMEDAS (c√°mbialo aqu√≠)\n    width = 30                  # ancho aproximado de la barra (d√≠as)\n  ) +\n  geom_col(\n    data = ~ subset(.x, spei &lt; 0),\n    aes(y = spei),\n    fill = \"darkred\",        # ‚Üê COLOR DE LAS BARRAS SECAS (c√°mbialo aqu√≠)\n    width = 30\n  ) +\n  \n  # Un panel por estaci√≥n meteorol√≥gica\n  facet_wrap(~ estacion, ncol = 1, scales = \"free_x\") +\n  \n  # T√≠tulos de los ejes y del gr√°fico\n  labs(\n    title = \"√çndice Estandarizado de Evotranspiraci√≥n (SPEI) de 12 meses\",\n    x     = \"A√±os\",\n    y     = \"Valor del balance h√≠drico\"\n  ) +\n  \n  # Tema visual general\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title   = element_text(face = \"bold\", hjust = 0.5),  # centrado\n    strip.text   = element_text(face = \"bold\", size = 14),    # t√≠tulos de los panels\n    axis.text.x  = element_text(angle = 45, hjust = 1),       # etiquetas de a√±os inclinadas\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n###########################################################\n# 9. (Opcional) Mismo tipo de gr√°fico, pero para SPEI-3\n###########################################################\nggplot(spei3_est, aes(x = fecha, y = spei)) +\n  geom_hline(yintercept = 0, color = \"grey40\", linewidth = 0.4) +\n  geom_col(\n    data = ~ subset(.x, spei &gt;= 0),\n    aes(y = spei),\n    fill = \"#6a994e\",        \n    width = 30\n  ) +\n  geom_col(\n    data = ~ subset(.x, spei &lt; 0),\n    aes(y = spei),\n    fill = \"darkred\",\n    width = 30\n  ) +\n  facet_wrap(~ estacion, ncol = 1, scales = \"free_x\") +\n  labs(\n    title = \"√çndice Estandarizado de Evotranspiraci√≥n (SPEI) de 3 meses\",\n    x     = \"A√±os\",\n    y     = \"Valor del balance h√≠drico\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title   = element_text(face = \"bold\", hjust = 0.5),\n    strip.text   = element_text(face = \"bold\", size = 14),\n    axis.text.x  = element_text(angle = 45, hjust = 1),\n    panel.grid.minor = element_blank()\n  )"
  },
  {
    "objectID": "spei.html#cargar-paquetes-y-datos",
    "href": "spei.html#cargar-paquetes-y-datos",
    "title": "An√°lisis SPEI",
    "section": "",
    "text": "rm(list = ls())  # Limpia el entorno (opcional, para partir de cero)\n\n###########################################################\n# 1. Cargar paquetes necesarios\n###########################################################\npkgs &lt;- c(\"dplyr\", \"ggplot2\", \"SPEI\", \"lubridate\", \"purrr\", \"tibble\")\n\ninst &lt;- pkgs[!pkgs %in% installed.packages()[, \"Package\"]]\nif (length(inst) &gt; 0) install.packages(inst)\n\nlapply(pkgs, library, character.only = TRUE)\n\nWarning: package 'dplyr' was built under R version 4.5.2\n\n\n\nAdjuntando el paquete: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nWarning: package 'ggplot2' was built under R version 4.5.2\n\n\nWarning: package 'SPEI' was built under R version 4.5.2\n\n\n# Package SPEI (1.8.1) loaded [try SPEINews()].\n\n\nWarning: package 'lubridate' was built under R version 4.5.2\n\n\n\nAdjuntando el paquete: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\n\nWarning: package 'purrr' was built under R version 4.5.2\n\n\nWarning: package 'tibble' was built under R version 4.5.2\n\n\n[[1]]\n[1] \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\" \n[7] \"methods\"   \"base\"     \n\n[[2]]\n[1] \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\" \"utils\"    \n[7] \"datasets\"  \"methods\"   \"base\"     \n\n[[3]]\n [1] \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\"\n [7] \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[4]]\n [1] \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"     \"graphics\" \n [7] \"grDevices\" \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[5]]\n [1] \"purrr\"     \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"     \"stats\"    \n [7] \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"  \"methods\"   \"base\"     \n\n[[6]]\n [1] \"tibble\"    \"purrr\"     \"lubridate\" \"SPEI\"      \"ggplot2\"   \"dplyr\"    \n [7] \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"  \"methods\"  \n[13] \"base\"     \n\n###########################################################\n# 2. Leer las bases de cada estaci√≥n\n###########################################################\n\ncogoti_raw &lt;- read.csv(\n  \"data/cogoti_spei.csv\",\n  header = TRUE,\n  stringsAsFactors = FALSE\n)\n\nramadas_raw &lt;- read.csv(\n  \"data/ramadas_spei.csv\",\n  header = TRUE,\n  stringsAsFactors = FALSE,\n  sep = \";\"\n)\n\n# Revisa c√≥mo se llaman las columnas\nnames(cogoti_raw)\n\n[1] \"agno\" \"mes\"  \"dia\"  \"pmen\" \"tmax\" \"tmin\"\n\nnames(ramadas_raw)\n\n[1] \"agno\" \"mes\"  \"dia\"  \"pmen\" \"tmax\" \"tmin\"\n\n###########################################################\n# 3. Dejar los mismos nombres de columnas en ambas bases\n#    (agno, mes, dia, pmen, tmax, tmin)\n###########################################################\nnames(cogoti_raw)  &lt;- c(\"agno\", \"mes\", \"dia\", \"pmen\", \"tmax\", \"tmin\")\nnames(ramadas_raw) &lt;- c(\"agno\", \"mes\", \"dia\", \"pmen\", \"tmax\", \"tmin\")\n\n###########################################################\n# 4. Crear columna de fecha y marcar estaci√≥n meteorol√≥gica\n###########################################################\ncogoti &lt;- cogoti_raw |&gt;\n  mutate(\n    estacion = \"Cogot√≠\",\n    fecha    = make_date(year = agno, month = mes, day = dia)\n  )\n\nramadas &lt;- ramadas_raw |&gt;\n  mutate(\n    estacion = \"Las Ramadas\",\n    fecha    = make_date(year = agno, month = mes, day = dia)\n  )\n\n###########################################################\n# 5. Unir ambas estaciones en un solo data frame\n###########################################################\ndatos &lt;- bind_rows(cogoti, ramadas) |&gt;\n  arrange(estacion, fecha)\n\n###########################################################\n# 6. Calcular ETP (Hargreaves) y balance h√≠drico\n###########################################################\n# IMPORTANTE:\n# - Aqu√≠ puedes filtrar NAs si tu base tiene d√≠as/meses sin datos (ac√° hubieron como 4 datos perdidos OJITO).\n#   Ejemplo: filter(!is.na(tmax), !is.na(tmin), !is.na(pmen))\n###########################################################\ndatos &lt;- datos |&gt;\n  mutate(\n    etp  = hargreaves(tmin, tmax, lat = -31.035833),  # Cambia lat si quieres otra\n    bal  = pmen - etp\n  )\n\n[1] \"Calculating reference evapotranspiration using the Hargreaves method. Using latitude (`lat`) to estimate extraterrestrial radiation. Checking for missing values (`NA`): all the data must be complete. Input type is vector. Assuming the data are monthly time series starting in January, all regular (non-leap) years.\"\n\n###########################################################\n# 7. Usar purrr para calcular SPEI por estaci√≥n meteo\n###########################################################\n# Separa la base en una lista: una tabla por estaci√≥n (\"Cogot√≠\", \"Ramadas\")\nlista_est &lt;- split(datos, datos$estacion)\n\n# Funci√≥n que calcula SPEI k-mensual para una estaci√≥n\ncalc_spei_estacion &lt;- function(df, escala = 12) {\n  df &lt;- df[order(df$fecha), ]      # Ordenar por fecha por si acaso\n  spei_obj &lt;- spei(df$bal, escala) # C√°lculo de SPEI\n  \n  tibble(\n    fecha    = df$fecha,\n    estacion = unique(df$estacion),\n    spei     = as.numeric(spei_obj$fitted),\n    escala   = escala\n  )\n}\n\n# SPEI-12 meses \nspei12_est &lt;- map_dfr(lista_est, calc_spei_estacion, escala = 12)\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 12. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 12. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n\n# (Opcional) SPEI-3 meses:\nspei3_est  &lt;- map_dfr(lista_est, calc_spei_estacion, escala = 3)\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 3. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 3. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n\n###########################################################\n# 8. Gr√°fico tipo ‚Äúpluma‚Äù SPEI-12 (barras azules/rojas)\n###########################################################\n# AQU√ç ES DONDE PUEDES CAMBIAR:\n# - Colores de seco/h√∫medo (scale_fill_manual)\n# - T√≠tulo, ejes, tama√±o de letra (labs + theme)\n# - N¬∞ de columnas de los facets (facet_wrap)\n###########################################################\n\nggplot(spei12_est, aes(x = fecha, y = spei)) +\n  # L√≠nea horizontal en 0 (umbral neutral)\n  geom_hline(yintercept = 0, color = \"grey40\", linewidth = 0.4) +\n  \n  # Barras: las positivas van hacia arriba, las negativas hacia abajo\n  # Usamos ifelse dentro de aes(y = ...) para que siempre partan desde 0\n  geom_col(\n    data = ~ subset(.x, spei &gt;= 0),\n    aes(y = spei),\n    fill = \"#6a994e\",        # ‚Üê COLOR DE LAS BARRAS H√öMEDAS (c√°mbialo aqu√≠)\n    width = 30                  # ancho aproximado de la barra (d√≠as)\n  ) +\n  geom_col(\n    data = ~ subset(.x, spei &lt; 0),\n    aes(y = spei),\n    fill = \"darkred\",        # ‚Üê COLOR DE LAS BARRAS SECAS (c√°mbialo aqu√≠)\n    width = 30\n  ) +\n  \n  # Un panel por estaci√≥n meteorol√≥gica\n  facet_wrap(~ estacion, ncol = 1, scales = \"free_x\") +\n  \n  # T√≠tulos de los ejes y del gr√°fico\n  labs(\n    title = \"√çndice Estandarizado de Evotranspiraci√≥n (SPEI) de 12 meses\",\n    x     = \"A√±os\",\n    y     = \"Valor del balance h√≠drico\"\n  ) +\n  \n  # Tema visual general\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title   = element_text(face = \"bold\", hjust = 0.5),  # centrado\n    strip.text   = element_text(face = \"bold\", size = 14),    # t√≠tulos de los panels\n    axis.text.x  = element_text(angle = 45, hjust = 1),       # etiquetas de a√±os inclinadas\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n###########################################################\n# 9. (Opcional) Mismo tipo de gr√°fico, pero para SPEI-3\n###########################################################\nggplot(spei3_est, aes(x = fecha, y = spei)) +\n  geom_hline(yintercept = 0, color = \"grey40\", linewidth = 0.4) +\n  geom_col(\n    data = ~ subset(.x, spei &gt;= 0),\n    aes(y = spei),\n    fill = \"#6a994e\",        \n    width = 30\n  ) +\n  geom_col(\n    data = ~ subset(.x, spei &lt; 0),\n    aes(y = spei),\n    fill = \"darkred\",\n    width = 30\n  ) +\n  facet_wrap(~ estacion, ncol = 1, scales = \"free_x\") +\n  labs(\n    title = \"√çndice Estandarizado de Evotranspiraci√≥n (SPEI) de 3 meses\",\n    x     = \"A√±os\",\n    y     = \"Valor del balance h√≠drico\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title   = element_text(face = \"bold\", hjust = 0.5),\n    strip.text   = element_text(face = \"bold\", size = 14),\n    axis.text.x  = element_text(angle = 45, hjust = 1),\n    panel.grid.minor = element_blank()\n  )"
  },
  {
    "objectID": "spei.html#calcular-etp-y-balance-h√≠drico",
    "href": "spei.html#calcular-etp-y-balance-h√≠drico",
    "title": "An√°lisis SPEI",
    "section": "Calcular ETP y balance h√≠drico",
    "text": "Calcular ETP y balance h√≠drico\n\n\nCode\n# Calcular ETP con Hargreaves\ndatos_cogoti$ETP_har &lt;- hargreaves(\n  datos_cogoti$tmin,\n  datos_cogoti$tmax,\n  lat = -31.035833\n)\n\n\n[1] \"Calculating reference evapotranspiration using the Hargreaves method. Using latitude (`lat`) to estimate extraterrestrial radiation. Checking for missing values (`NA`): all the data must be complete. Input type is vector. Assuming the data are monthly time series starting in January, all regular (non-leap) years.\"\n\n\nCode\n# Balance Pp - ETP\ndatos_cogoti$BAL &lt;- datos_cogoti$pmen - datos_cogoti$ETP_har\n\nhead(datos_cogoti)\n\n\n  agno mes dia pmen tmax tmin   ETP_har        BAL\n1 1970   1   3    0 26.4 13.3 171.29881 -171.29881\n2 1970   2   3    0 27.0 13.7 144.51789 -144.51789\n3 1970   3   3    0 26.1 12.5 135.22628 -135.22628\n4 1970   4   3    0 25.0  9.8 103.23657 -103.23657\n5 1970   5   3   22 19.4  7.3  65.68723  -43.68723\n6 1970   6   3    0 17.9  3.5  54.66745  -54.66745"
  },
  {
    "objectID": "spei.html#calcular-spei-a-3-y-12-meses",
    "href": "spei.html#calcular-spei-a-3-y-12-meses",
    "title": "An√°lisis SPEI",
    "section": "Calcular SPEI a 3 y 12 meses",
    "text": "Calcular SPEI a 3 y 12 meses\n\n\nCode\nspei3  &lt;- spei(datos_cogoti$BAL, 3)\n\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 3. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\"\n\n\nCode\nspei12 &lt;- spei(datos_cogoti$BAL, 12)\n\n\n[1] \"Calculating the Standardized Precipitation Evapotranspiration Index (SPEI) at a time scale of 12. Using kernel type 'rectangular', with 0 shift. Fitting the data to a log-Logistic distribution. Using the ub-pwm parameter fitting method. Checking for missing values (`NA`): all the data must be complete. Using the whole time series as reference period. Input type is vector. No time information provided, assuming a monthly time series.\""
  },
  {
    "objectID": "spei.html#gr√°fico-spei-12-meses",
    "href": "spei.html#gr√°fico-spei-12-meses",
    "title": "An√°lisis SPEI",
    "section": "Gr√°fico SPEI 12 meses",
    "text": "Gr√°fico SPEI 12 meses\n\n\nCode\nplot(spei12, main = \"SPEI (12 meses) ‚Äì Estaci√≥n Cogot√≠\")\n\n\nWarning: Removed 540 rows containing missing values or values outside the scale range\n(`geom_point()`)."
  },
  {
    "objectID": "spei.html#gr√°fico-spei-3-meses",
    "href": "spei.html#gr√°fico-spei-3-meses",
    "title": "An√°lisis SPEI",
    "section": "Gr√°fico SPEI 3 meses",
    "text": "Gr√°fico SPEI 3 meses\n\n\nCode\nplot(spei3, main = \"SPEI (3 meses) ‚Äì Estaci√≥n Cogot√≠\")\n\n\nWarning: Removed 549 rows containing missing values or values outside the scale range\n(`geom_point()`)."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "spei.html#calcular-etp-y-balance-h√≠drico-estaci√≥n-cogot√≠",
    "href": "spei.html#calcular-etp-y-balance-h√≠drico-estaci√≥n-cogot√≠",
    "title": "An√°lisis SPEI",
    "section": "Calcular ETP y balance h√≠drico ‚Äì Estaci√≥n Cogot√≠",
    "text": "Calcular ETP y balance h√≠drico ‚Äì Estaci√≥n Cogot√≠"
  },
  {
    "objectID": "spei.html#calcular-spei-a-3-y-12-meses-estaci√≥n-cogot√≠",
    "href": "spei.html#calcular-spei-a-3-y-12-meses-estaci√≥n-cogot√≠",
    "title": "An√°lisis SPEI",
    "section": "Calcular SPEI a 3 y 12 meses ‚Äì Estaci√≥n Cogot√≠",
    "text": "Calcular SPEI a 3 y 12 meses ‚Äì Estaci√≥n Cogot√≠"
  },
  {
    "objectID": "spei.html#gr√°ficos-spei-estaci√≥n-cogot√≠",
    "href": "spei.html#gr√°ficos-spei-estaci√≥n-cogot√≠",
    "title": "An√°lisis SPEI",
    "section": "Gr√°ficos SPEI ‚Äì Estaci√≥n Cogot√≠",
    "text": "Gr√°ficos SPEI ‚Äì Estaci√≥n Cogot√≠\n\n# SPEI 12 meses ‚Äì Cogot√≠\nplot(\n  spei12_cogoti$fitted,\n  type = \"l\",\n  main = \"SPEI (12 meses) ‚Äì Estaci√≥n Cogot√≠\",\n  xlab = \"Tiempo\",\n  ylab = \"SPEI\"\n)\nabline(h = c(-2, -1, 0, 1, 2), lty = c(2, 3, 1, 3, 2))\n\n\n\n\n\n\n\n# SPEI 3 meses ‚Äì Cogot√≠\nplot(\n  spei3_cogoti$fitted,\n  type = \"l\",\n  main = \"SPEI (3 meses) ‚Äì Estaci√≥n Cogot√≠\",\n  xlab = \"Tiempo\",\n  ylab = \"SPEI\"\n)\nabline(h = c(-2, -1, 0, 1, 2), lty = c(2, 3, 1, 3, 2))"
  },
  {
    "objectID": "spei.html#calcular-etp-y-balance-h√≠drico-estaci√≥n-ramadas",
    "href": "spei.html#calcular-etp-y-balance-h√≠drico-estaci√≥n-ramadas",
    "title": "An√°lisis SPEI",
    "section": "Calcular ETP y balance h√≠drico ‚Äì Estaci√≥n Ramadas",
    "text": "Calcular ETP y balance h√≠drico ‚Äì Estaci√≥n Ramadas"
  },
  {
    "objectID": "spei.html#calcular-spei-a-3-y-12-meses-estaci√≥n-ramadas",
    "href": "spei.html#calcular-spei-a-3-y-12-meses-estaci√≥n-ramadas",
    "title": "An√°lisis SPEI",
    "section": "Calcular SPEI a 3 y 12 meses ‚Äì Estaci√≥n Ramadas",
    "text": "Calcular SPEI a 3 y 12 meses ‚Äì Estaci√≥n Ramadas"
  },
  {
    "objectID": "spei.html#gr√°ficos-spei-estaci√≥n-ramadas",
    "href": "spei.html#gr√°ficos-spei-estaci√≥n-ramadas",
    "title": "An√°lisis SPEI",
    "section": "Gr√°ficos SPEI ‚Äì Estaci√≥n Ramadas",
    "text": "Gr√°ficos SPEI ‚Äì Estaci√≥n Ramadas\n\n# SPEI 12 meses ‚Äì Ramadas\nplot(\n  spei12_ramadas$fitted,\n  type = \"l\",\n  main = \"SPEI (12 meses) ‚Äì Estaci√≥n Ramadas\",\n  xlab = \"Tiempo\",\n  ylab = \"SPEI\"\n)\nabline(h = c(-2, -1, 0, 1, 2), lty = c(2, 3, 1, 3, 2))\n\n\n\n\n\n\n\n# SPEI 3 meses ‚Äì Ramadas\nplot(\n  spei3_ramadas$fitted,\n  type = \"l\",\n  main = \"SPEI (3 meses) ‚Äì Estaci√≥n Ramadas\",\n  xlab = \"Tiempo\",\n  ylab = \"SPEI\"\n)\nabline(h = c(-2, -1, 0, 1, 2), lty = c(2, 3, 1, 3, 2))"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "An√°lisis exploratorio de la sequ√≠a en Cogot√≠ y Las Ramadas (Regi√≥n de Coquimbo, Chile)",
    "section": "",
    "text": "Viejo mirando a los caballos oh el weon amanerao"
  },
  {
    "objectID": "index.html#qu√©-puedes-ver-en-este-sitio",
    "href": "index.html#qu√©-puedes-ver-en-este-sitio",
    "title": "Inicio",
    "section": "",
    "text": "Una breve tabla con los primeros registros de cada estaci√≥n.\nGr√°ficos del SPEI a 12 meses, que permiten ver tendencias de sequ√≠a prolongada.\nGr√°ficos del SPEI a 3 meses, √∫tiles para variaciones m√°s r√°pidas en la disponibilidad h√≠drica.\n\nPuedes ir directamente al an√°lisis detallado ac√°:\n\nüëâ Ver an√°lisis SPEI"
  },
  {
    "objectID": "index.html#notas-t√©cnicas",
    "href": "index.html#notas-t√©cnicas",
    "title": "An√°lisis exploratorio de la sequ√≠a en Cogot√≠ y Las Ramadas (Regi√≥n de Coquimbo, Chile)",
    "section": "Notas t√©cnicas",
    "text": "Notas t√©cnicas\n\nDatos provenientes de la plataforma https://explorador.cr2.cl del Centro de Ciencia del Clima y Resiliencia (CR2)\nDatos utilizados: series mensuales de precipitaci√≥n (mm), temperatura m√°xima (¬∞C) y m√≠nima (¬∞C).\nUso del paquete SPEI en RStudio con el c√°lculo de Evotranspiraci√≥n: funci√≥n hargreaves()\nC√°lculo de SPEI: funci√≥n spei() del mismo paquete, para escalas de 3 y 12 meses.\nSitio generado con Quarto y publicado como website est√°tico."
  },
  {
    "objectID": "spei.html#cargar-paquetes-y-datos-1",
    "href": "spei.html#cargar-paquetes-y-datos-1",
    "title": "An√°lisis SPEI",
    "section": "Cargar paquetes y datos",
    "text": "Cargar paquetes y datos\nrm(list = ls()) # Limpia el entorno"
  },
  {
    "objectID": "spei.html#cargar-paquetes-leer-datos-y-calcular-spei",
    "href": "spei.html#cargar-paquetes-leer-datos-y-calcular-spei",
    "title": "An√°lisis SPEI",
    "section": "",
    "text": "rm(list = ls()) # Limpia el entorno"
  },
  {
    "objectID": "index.html#exploraci√≥n-de-datos",
    "href": "index.html#exploraci√≥n-de-datos",
    "title": "An√°lisis exploratorio de la sequ√≠a en Cogot√≠ y Las Ramadas (Regi√≥n de Coquimbo, Chile)",
    "section": "Exploraci√≥n de datos",
    "text": "Exploraci√≥n de datos\n\nUna serie con los registros de cada estaci√≥n.\nGr√°ficos del SPEI a 12 meses, que permiten ver tendencias de sequ√≠a prolongada en el tiempo.\nGr√°ficos del SPEI a 3 meses, √∫tiles para variaciones m√°s r√°pidas en la disponibilidad h√≠drica, siendo √∫til para evaluar los efectos en actividades de agricultura y ganader√≠a.\n\n\n\n\nLa foto mas HD que pude encontrar\n\n\nPuedes ir directamente al an√°lisis detallado ac√°:\n\nüëâ Ver an√°lisis SPEI\n\n\n\n\n## Conclusiones"
  }
]